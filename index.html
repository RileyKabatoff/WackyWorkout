<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="description" content="Track your fitness journey with Wacky Workout Tracker. Log workouts, set goals, and monitor your progress with our easy-to-use fitness dashboard.">
  
  <meta name="keywords" content="workout tracker, fitness app, exercise log, fitness goals, workout dashboard, fitness progress">
  
  <meta name="author" content="Wacky Workout Team">
  
  <title>Dashboard - Wacky Workout Tracker</title>
  
  <link rel="icon" href="favicon.ico" type="image/x-icon">
  
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  
  <div class="container">
    <header class="header">
      <div class="header-left">
        <span class="flame-icon">ğŸ”¥</span>
        <h1 class="header-title">WACKY WORKOUT</h1>
        <span class="flame-icon">ğŸ”¥</span>
      </div>
      <div class="header-right">
        <!-- ADDITIONAL COMPONENT 2 - Theme Toggle Button
             This button toggles between dark and light modes by adding/removing a CSS class
             The toggleDarkMode() function uses classList.toggle() to switch the 'light-mode' class
             This demonstrates dynamic styling changes across the entire page -->
        <button onclick="toggleDarkMode()" class="btn-logout" style="margin-right: 1rem;">
          <span>ğŸŒ“</span>
          Toggle Theme
        </button>
        
        <div class="streak-badge">
          <div class="streak-number" id="streakNumber">0</div>
          <div class="streak-label">Day Streak ğŸ”¥</div>
        </div>
        <button class="btn-logout" id="logoutBtn">
          <span>â†©ï¸</span>
          Logout
        </button>
      </div>
    </header>

    <nav class="nav-tabs">
      <a href="index.html" class="nav-tab active">
        <span>ğŸ“Š</span>
        Dashboard
      </a>
      <a href="logging.html" class="nav-tab">
        <span>â•</span>
        Log Workout
      </a>
      <a href="goals.html" class="nav-tab">
        <span>ğŸ¯</span>
        Goals
      </a>
      <a href="progress.html" class="nav-tab">
        <span>ğŸ“ˆ</span>
        Progress
      </a>
      <a href="about.html" class="nav-tab">
        <span>ğŸ‘¤</span>
        About
      </a>
    </nav>

    <main>
      <div class="stats-grid" id="statsGrid">
      </div>
      <div class="card card-light">
        <h2 class="card-title card-title-dark">Recent Workouts</h2>
        
        <!-- ADDITIONAL COMPONENT 1 - Search/Filter Functionality
             This input field allows users to filter the workout list in real-time as they type
             The oninput event triggers the filterWorkouts() function which shows/hides workout items
             based on whether their exercise name matches the search term -->
        <div style="margin-bottom: 1rem;">
          <input type="text" 
                 id="workoutSearch" 
                 placeholder="ğŸ” Search workouts by exercise name..." 
                 oninput="filterWorkouts(this.value)"
                 style="width: 100%; padding: 0.75rem; border: 2px solid #d1d5db; border-radius: 0.5rem; background: white; color: #000;">
        </div>
        
        <div class="workout-list" id="workoutList">
          <!-- Workouts will be populated by JavaScript -->
        </div>
      </div>

      <!-- Secret Section with Password Access -->
      <div class="card">
        <h2 class="card-title">ğŸ”’ Secret Advanced Statistics</h2>
        <p style="color: #fca5a5; margin-bottom: 1rem;">Enter password to access advanced analytics:</p>
        <div style="display: flex; gap: 0.5rem; margin-bottom: 1rem;">
          <input type="password" id="secretPasswordInput" placeholder="Enter password" style="flex: 1;">
          <button onclick="checkSecretPassword()" class="btn btn-primary" style="width: auto; padding: 0.75rem 1.5rem;">Unlock</button>
        </div>
        <p id="passwordError" style="color: #ef4444; display: none; margin-bottom: 1rem;"></p>
        
        <!-- CHANGE FORMATTING - This section is hidden by default (display: none) and becomes visible when correct password is entered
             The checkSecretPassword() function toggles the display property from 'none' to 'block', making the content appear
             This demonstrates dynamic formatting changes based on user interaction -->
        <div id="secretSection" style="display: none;">
          <h3 style="color: #34d399; margin-bottom: 1rem;">âœ“ Access Granted - Advanced Statistics</h3>
          <div style="background: rgba(127, 29, 29, 0.3); padding: 1.5rem; border-radius: 0.5rem; border: 2px solid #34d399;">
            <p style="color: #fca5a5; margin-bottom: 1rem;">ğŸ”¬ Advanced Analytics Dashboard</p>
            <div style="color: white;">
              <p><strong>ğŸ¯ Success Rate:</strong> 94.5%</p>
              <p><strong>ğŸ“Š Average Improvement:</strong> +12.3% per week</p>
              <p><strong>ğŸ† Predicted Goal Achievement:</strong> 2 weeks ahead of schedule</p>
              <p><strong>ğŸ’ª Power User Status:</strong> Top 5% of all users</p>
              <p style="margin-top: 1rem; color: #34d399;"><em>You're Doing Great</em></p>
            </div>
          </div>
        </div>
      </div>
    </main>

    <footer class="footer">
      <div class="footer-content">
        <h3>Contact Us</h3>
        <p>Email: support@wackyworkout.com</p>
        <p>Phone: (555) 123-4567</p>
        <p>Address: 123 Fitness Street, Workout City, WC 12345</p>
      </div>
    </footer>
  </div>

<script src="app.js"></script>
<script>
  // Check authentication
  const currentUser = JSON.parse(sessionStorage.getItem('currentUser'));
  if (!currentUser) {
    window.location.href = 'login.html';
  }
  
  // Initialize page with async function
  async function initDashboard() {
    try {
      // Update streak display
      getStreak().then(streak => {
        document.getElementById('streakNumber').textContent = streak;
      });
      
      // Fetch and display stats
      const stats = await calculateStats();
      
      document.getElementById('statsGrid').innerHTML = `
        <div class="stat-card">
          <div class="stat-value">${stats.total}</div>
          <div class="stat-label">Total Workouts</div>
        </div>
        <div class="stat-card">
          <div class="stat-value">${stats.reps}</div>
          <div class="stat-label">Total Reps</div>
        </div>
        <div class="stat-card">
          <div class="stat-value">${Math.round(stats.weight)}</div>
          <div class="stat-label">Total Weight (lbs)</div>
        </div>
        <div class="stat-card">
          <div class="stat-value">${stats.duration}</div>
          <div class="stat-label">Minutes Trained</div>
        </div>
      `;
      
      // Fetch and display recent workouts
      const workouts = await getWorkouts();
      const workoutList = document.getElementById('workoutList');
      
      if (workouts.length === 0) {
        workoutList.innerHTML = '<p class="empty-state empty-state-dark">No workouts yet! Log your first workout.</p>';
      } else {
        // Display most recent 5 workouts
        const recentWorkouts = workouts.slice(0, 5);
        workoutList.innerHTML = recentWorkouts.map(w => `
          <div class="workout-item">
            <div>
              <p class="workout-name">${w.exercise_name}</p>
              <p class="workout-details">${w.sets}Ã—${w.reps} â€¢ ${w.duration}min â€¢ ${w.weight}lbs</p>
            </div>
            <div class="workout-actions">
              <button class="icon-btn" onclick="editWorkout(${w.workout_id})">âœï¸</button>
              <button class="icon-btn" onclick="deleteWorkout(${w.workout_id})">ğŸ—‘ï¸</button>
            </div>
          </div>
        `).join('');
      }
      
    } catch (error) {
      console.error('Error initializing dashboard:', error);
      alert('Error loading dashboard data');
    }
  }
  
  // Edit workout function
  function editWorkout(id) {
    alert('Edit functionality - To be implemented in future update');
    // Future: Could redirect to editing page or open modal
  }
  
  // Delete workout function
  async function deleteWorkout(id) {
    if (!confirm('Are you sure you want to delete this workout?')) {
      return;
    }
    
    try {
      const response = await fetch(`http://localhost:3000/api/workouts/${id}`, {
        method: 'DELETE'
      });
      
      const result = await response.json();
      
      if (!response.ok) {
        alert(result.error || 'Failed to delete workout');
        return;
      }
      
      alert('Workout deleted successfully!');
      
      // Reload dashboard
      initDashboard();
      
    } catch (error) {
      console.error('Error deleting workout:', error);
      alert('An error occurred while deleting the workout');
    }
  }
  
  // Initialize dashboard on page load
  initDashboard();
</script>
</body>
</html>
